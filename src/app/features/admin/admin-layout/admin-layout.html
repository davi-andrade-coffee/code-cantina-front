<div class="admin-layout min-h-screen bg-base-300 text-base-content">
  <!-- Topbar -->
  <div class="navbar bg-base-200 border-b border-base-100 px-4">
    <div class="flex-1 gap-3">
      <div class="font-semibold">Cantina Escolar</div>
      <div class="text-xs opacity-70">Painel Admin</div>
    </div>

    <div class="flex items-center gap-2">
      <div class="text-right leading-tight">
        <div class="text-xs opacity-70">{{ userEmail }}</div>
        <div class="text-xs font-medium">{{ userRole }}</div>
      </div>

      <button class="btn btn-sm btn-error" (click)="logout()">Sair</button>
      <button class="btn btn-sm btn-ghost" (click)="toggleTheme()">
        {{ theme === 'dark' ? 'Light' : 'Dark' }}
      </button>
    </div>
  </div>

  <div class="flex">
    <!-- Sidebar -->
    <aside class="w-72 min-h-[calc(100vh-64px)] bg-base-200 border-r border-base-100 p-3">
      <div class="text-xs opacity-70 px-2 pb-2">Navegação</div>

      <ng-container *ngFor="let section of menu">
        <div class="mt-3 text-xs font-semibold opacity-70 px-2">
          {{ section.title }}
        </div>

        <ul class="menu menu-sm">
          <ng-container *ngFor="let item of section.items">
            <li>
              <ng-container *ngIf="!item.children?.length; else hasChildren">
                <a [routerLink]="item.path"
                   [class.active]="isActive(item)"
                   class="rounded-md">
                  {{ item.label }}
                </a>
              </ng-container>

              <ng-template #hasChildren>
                <details [open]="isOpenGroup(item)">
                  <summary class="rounded-md">{{ item.label }}</summary>
                  <ul>
                    <li *ngFor="let child of item.children">
                      <a [routerLink]="child.path"
                         [class.active]="isActive(child)"
                         class="rounded-md">
                        {{ child.label }}
                      </a>
                    </li>
                  </ul>
                </details>
              </ng-template>
            </li>
          </ng-container>
        </ul>
      </ng-container>
    </aside>

    <!-- Content -->
    <main class="flex-1 p-6">
      <!-- Breadcrumbs -->
      <div class="breadcrumbs text-sm mb-4 opacity-80">
        <ul>
          <li><a [routerLink]="'/admin'">Admin</a></li>
          <li *ngFor="let bc of breadcrumbs()">{{ bc }}</li>
        </ul>
      </div>

      <!-- Page slot -->
      <div class="bg-base-200 border border-base-100 rounded-xl p-5 min-h-[70vh]">
        <router-outlet />
      </div>
    </main>
  </div>
</div>
